<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="copyright" content="2000, 2002, 2005, 2007 phpBB Group" />
<meta name="keywords" content="weather research and forecast model, wrf, weather forecasting, wrf post-processing, wrf installation, wrf configuration, wrf forum, wrf community" />
<meta name="description" content="The WRF User's Forum. An active forum dedicated to helping support the Weather Research and Forecast Model's developers and users alike." />

<title>WRF User's Forum &bull; View topic - Metgrid, PRES, and the intermediate file format</title>

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      
	
	NOTE: This page was generated by phpBB, the free open-source bulletin board package.
	      The phpBB Group is not responsible for the content of this page and forum. For more information
	      about phpBB please visit http://www.phpbb.com
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '2';
	var per_page = '10';
	var base_url = './viewtopic.php?f=22&amp;t=2481';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=forum.wrfforum.com';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	}

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	}

// ]]>
</script>
<script type="text/javascript" src="./styles/prosilver_se/template/styleswitcher.js"></script>
<script type="text/javascript" src="./styles/prosilver_se/template/forum_fn.js"></script>

<link href="./styles/prosilver_se/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?id=2&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/prosilver_se/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/prosilver_se/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/prosilver_se/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-353475-23");
pageTracker._initData();
pageTracker._trackPageview();
</script>
</head>

<body id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
    <div class="border-left">
    <div class="border-right">
    <div class="border-top">
    <div class="border-top-left">
    <div class="border-top-right">
        <div class="inside" style="direction: ltr; ">
        	<a id="top" name="top" accesskey="t"></a>
        	<div id="page-header">
        		<div class="headerbar">
        			<div class="inner"><span class="corners-top"><span></span></span>
        
        			<div id="site-description">
<!--START MATT EDIT-->
<!--ORIG-->
<!--
        				<a href="./index.php" title="Board index" id="logo"><img src="./styles/prosilver_se/imageset/site_logo.gif" width="139" height="52" alt="" title="" /></a>
        				<h1>WRF User's Forum</h1>
        				<p>The WRF User's Forum.  This is the place to ask all of your numerical modeling, post processing, etc questions as they relate to the WRF.</p>
-->
<!--NEW-->

        				<a href="./index.php" title="Board index" id="logo"><img src="/header_forum.jpg" width="820" height="69" alt="" title="" /></a>

<!--END MATT EDIT-->
        				<p style="display: none;"><a href="#start_here">Skip to content</a></p>
        			</div>
        

        		
        			<div id="search-box" style="display:none;">
        				<form action="./search.php" method="post" id="search">
        				<fieldset>
        					<input name="keywords" id="keywords" type="text" maxlength="128" title="Search for keywords" class="inputbox search" value="Search…" onclick="if(this.value=='Search…')this.value='';" onblur="if(this.value=='')this.value='Search…';" /> 
        					<input class="button2" value="Search" type="submit" /><br />
        					<a href="./search.php" title="View the advanced search options">Advanced search</a> 
        				</fieldset>
        				</form>
        			</div>
        		
        
        			<span class="corners-bottom"><span></span></span></div>
        		</div>
        
        		<div class="navbar">
        			<div class="inner"><span class="corners-top"><span></span></span>
        
        			<ul class="linklist navlinks">
        				<li class="icon-home"><a href="./index.php" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="./viewforum.php?f=19">WRF Preprocessing System (WPS, for WRF v2.2 and later versions)</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=22">Working with Various Datasets</a></li>
        
        				<li class="rightside"><a href="#" onclick="fontsizeup(); return false;" onkeypress="fontsizeup(); return false;" class="fontsize" title="Change font size">Change font size</a></li>
        
        				<li class="rightside"><a href="./viewtopic.php?f=22&amp;t=2481&amp;start=10&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>
        			</ul>
        
        			
        
        			<ul class="linklist rightside">
        				<li class="icon-faq"><a href="./faq.php" title="Frequently Asked Questions">FAQ</a></li>
        				<li class="icon-register"><a href="./ucp.php?mode=register">Register</a></li>
        					<li class="icon-logout"><a href="./ucp.php?mode=login" title="Login" accesskey="l">Login</a></li>
        				
        			</ul>
        
        			<span class="corners-bottom"><span></span></span></div>
        		</div>
        
        	</div>
        
        	<a name="start_here"></a>
        	<div id="page-body">
        		
        		 
<h2><a href="./viewtopic.php?f=22&amp;t=2481&amp;start=10">Metgrid, PRES, and the intermediate file format</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Dataset specific topics involving WPS.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=22&amp;t=2481" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="search-box">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" name="t" value="2481" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
		<div class="pagination">
			11 posts
			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>2</strong> of <strong>2</strong></a> &bull; <span><a href="./viewtopic.php?f=22&amp;t=2481">1</a><span class="page-sep">, </span><strong>2</strong></span>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p16645" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="#p16645">Re: Metgrid, PRES, and the intermediate file format</a></h3>
			<p class="author"><a href="./viewtopic.php?p=16645#p16645"><img src="./styles/prosilver_se/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="./memberlist.php?mode=viewprofile&amp;u=7202">alsayed</a></strong> &raquo; Wed Apr 11, 2012 4:30 am </p>

			

			<div class="content">Hello all,<br /><br /> I've solved the problem. I've written a simple fortran code that computes the File we used in metgrid.exe. <br />------<br />program sample_read<br />! Fortran 90 version.<br /><br />!   This is a simple program to write data in the WPS intermediate<br />!   format.  It is included mainly as an aid to understanding said<br />!   format.<br /><br />!  implicit none<br />  include '/usr/local/netcdf-4.1.3-gcc45/include/netcdf.inc'<br />  real*4, dimension(128,64,10,365,5) :: VARESULT<br />  real*4 , dimension(1:64) :: ALAT<br />  real*4 , dimension(1:128) :: ALON<br />  real*4 , dimension(1:365) :: ATIME<br />  real*4 , dimension(10) :: PRESSURET<br />  integer :: itim<br />  character(len=19) , dimension(1:365) :: get_timeid<br />  character(len=4) variable(5),varn(5)<br />  character*32 :: filename<br />! WRF CODE DECLARATIONS<br /><br />  integer nl<br />  integer, parameter :: IUNIT = 10<br />  integer, parameter :: OUNIT = 11<br />  integer :: ierr,ns<br />! format WPS=5<br />  integer :: VERSION=5<br />! The time, in format &quot;YYYY-MM-DD_HH:mm:ss<br />  character(len=24) :: HDATE<br />! Forecast time (in hours) of the data in the slab<br />  real :: XFCST = 0<br />! Start location of data. Could be &quot;CENTER&quot; or &quot;SWCORNER&quot;. &quot;SWCORNER&quot; is typical.<br />  character(len=8) :: STARTLOC = &quot;SWCORNER&quot;<br /><br />! A field name.<br />  character(len=9) :: FIELD<br />! A field name.<br /> character(len=9) , dimension(1:5) :: FIELD_i<br /><br />! Units describing the field in the slab.<br />  character(len=25) :: UNITS<br />! Units describing the field in the slab.<br />  character(len=25), dimension(1:5) :: UNITS_i<br /><br />! Text description of the field in the slab.<br />  character(len=46) :: DESC<br />! A field name.<br />  character(len=46) , dimension(1:5) :: DESC_i<br /><br />! Source of data<br />  character(len=32) :: MAP_SOURCE = &quot;Arpege&quot;<br />! Pressure-level (Pa) of the data.  200100 Pa indicates surface data; 201300 Pa indicates sea-level pressure<br />  real*4 XLVL<br />! Slab dimension in the X direction<br />  integer :: NX = 128<br />! Slab dimension in the Y direction<br />  integer :: NY = 64<br />! Flag denoting the projection, 0:  Cylindrical Equidistant (Lat/lon) projection.<br />  integer :: IPROJ = 0<br />! Starting latitude (degrees north)<br />  real :: STARTLAT = -87.8638<br />! Starting longitude (degrees east)<br />  real :: STARTLON = 0<br />! Latitude increment (degrees) for lat/lon grid<br />  real :: DELTALAT = 2.7672<br />!Longitude increment (degrees) for lat/lon grid<br />  real :: DELTALON = 2.8125<br />  real :: EARTH_RADIUS = 6367470. * .001<br />! Logical flag use to indicate if Lambert projected data has earth or model rotated winds.<br />  logical :: IS_WIND_EARTH_REL = .FALSE.<br /><br />! SLAB is an allocatable array, because we do not necessarily know in<br />! advance the size of the array we need to read.<br />!  real, allocatable, dimension(:,:) :: SLAB<br />! I decided to change the allocatable array feature for Fortran 90<br />! I get a segmentation fault when I try to pass the VARESULT to it<br />! I could also create a dummy slab, get the VARESULT and then pass it<br />! to the allocatable one. This takes a lot of memory!<br />! change made by Michel Mesquita - Nov 08<br /><br />  real , dimension(1:128,1:64) :: SLAB<br /><br /><br />! Reading PSL (PMSL in Metgrid - see Vtables) data<br /><br />!   Call subroutine I created to read the netcdf files<br />!   read_netcdf(ALAT,ALON,ATIME,VARESULT)<br />  print *, 'Reading subroutine sample_read...'<br />   PRESSURET(1)=100000;PRESSURET(2)=92500;PRESSURET(3)=85000;PRESSURET(4)=70000;PRESSURET(5)=60000<br />   PRESSURET(6)=50000;PRESSURET(7)=40000;PRESSURET(8)=30000;PRESSURET(9)=20000;PRESSURET(10)=10000<br /><br />  call read_netcdf_2(ALAT,ALON,ATIME,VARESULT)<br />!print *, 'VARESULT',VARESULT(:,:,:,:,5)<br />!print *, 'min est', minval(VARESULT(:,:,:,:,2)),maxval(VARESULT(:,:,:,:,2))<br />!print *, 'min est', minval(VARESULT(:,:,:,:,3)),maxval(VARESULT(:,:,:,:,3))<br />!print *, 'min est', minval(VARESULT(:,:,:,:,4)),maxval(VARESULT(:,:,:,:,4))<br />!print *, 'min est', minval(VARESULT(:,:,:,:,5)),maxval(VARESULT(:,:,:,:,5))<br />!print *, 'PRESSURET',PRESSURET<br /><br />! Call the subroutine get_time(get_timeid) in order to get<br />! info for the WRF variable HDATE<br /><br />  call get_time(get_timeid)<br /><br />! ------------------<br />   variable(1)='zg_d';varn(1)='zg';FIELD_i(1)='GHT';DESC_i(1)='Height';UNITS_i(1)='m'<br />   variable(2)='ta_d';varn(2)='ta';FIELD_i(2)='TT';DESC_i(2)='Temperature';UNITS_i(2)='K'<br />   variable(3)='ua_d';varn(3)='ua';FIELD_i(3)='UU';DESC_i(3)='U';UNITS_i(3)='m s-1'<br />   variable(4)='va_d';varn(4)='va';FIELD_i(4)='VV';DESC_i(4)='V';UNITS_i(4)='m s-1'<br />   variable(5)='hur_';varn(5)='hur';FIELD_i(5)='RH';DESC_i(5)='Relative Humidity';UNITS_i(5)='%'<br />! -----------------<br /> do nl=1,10<br /> do ns=1,5<br /> DATALOOP : DO itim = 1,365 ! Time dimension<br /><br />! Declare some WRF variables<br />  HDATE = get_timeid(itim)<br />!  print *, 'The date is: ', HDATE<br />  FIELD = FIELD_i(ns)  !&quot;SKINTEMP&quot; ! As in Metgrid - see Vtables<br />  UNITS = UNITS_i(ns)  !&quot;K&quot;<br />  DESC = DESC_i(ns)    !&quot;Temperature&quot;<br /><br />! Open and write a file name<br />        XLVL=PRESSURET(nl)<br />        SLAB = VARESULT(:,:,nl,itim,ns)<br />!    print *, ns,itim<br />!    if ( ( ns .eq. 5 ) .and. ( nl .eq. 1 ) .and. (itim .le. 10 ) )  then<br />!    print *, 'relative humidity',nl,itim,SLAB,SLAB<br />!    endif<br />!     print *, 'SLAB',minval(SLAB),maxval(SLAB)<br />      write (filename, 100) HDATE(1:10), HDATE(12:13)<br />100   format ('FILE:',a,'_',a)<br /><br />     open (IUNIT, FILE=filename, form='unformatted',access='append')<br />!      open (IUNIT, FILE=filename, form='unformatted',access='sequential',status='unknown')<br />!!!!!! Start the WRF Int Format coding:<br />     print *, 'writing the intermediate file format...', UNITS, DESC<br />     write (IUNIT, IOSTAT=IERR) VERSION<br /><br />     ! WRITE the second record, common to all projections:<br /><br />     write (IUNIT) HDATE, XFCST, MAP_SOURCE, FIELD, UNITS, DESC, XLVL, NX, NY, IPROJ<br /><br />     print*, HDATE//&quot;  &quot;, XLVL, FIELD<br /><br />     ! WRITE the third record, which depends on the projection:<br /><br />     if (IPROJ == 0) then<br /><br />        !  This is the Cylindrical Equidistant (lat/lon) projection:<br />        WRITE (IUNIT) STARTLOC, STARTLAT, STARTLON, DELTALAT, DELTALON, EARTH_RADIUS<br /><br />!     elseif (IPROJ == 1) then<br /><br />        ! This is the Mercator projection:<br />!        WRITE (IUNIT) STARTLOC, STARTLAT, STARTLON, DX, DY, TRUELAT1, EARTH_RADIUS<br />!     elseif (IPROJ == 3) then<br /><br />        ! This is the Lambert Conformal projection:<br />!        WRITE (IUNIT) STARTLOC, STARTLAT, STARTLON, DX, DY, XLONC, TRUELAT1, TRUELAT2, EARTH_RADIUS<br /><br /><br />!     elseif (IPROJ == 4) then<br /><br />        ! Gaussian projection<br />!        WRITE (IUNIT) STARTLOC, STARTLAT, STARTLON, NLATS, DELTALON, EARTH_RADIUS<br /><br />!     elseif (IPROJ == 5) then<br />        ! This is the Polar Stereographic projection:<br />!        WRITE (IUNIT) STARTLOC, STARTLAT, STARTLON, DX, DY, XLONC, TRUELAT1, EARTH_RADIUS<br /><br />     endif<br /><br /><br />     WRITE (IUNIT) IS_WIND_EARTH_REL<br /><br /><br />     WRITE (IUNIT) SLAB<br />   close (IUNIT)<br /><br />     ! Loop back to read/write the next field.<br /><br /><br />   ENDDO DATALOOP<br />    enddo<br />    enddo<br />  write(*,'(/,&quot;End of read loop.  Program finished.&quot;)')<br /><br />   print *, 'fin_values',minval(SLAB),maxval(SLAB)<br />end program sample_read<br />!   ***************************************************************<br />!   *  Subroutine to read a text file with the TIME strings       *<br />!   *  Created by Michel Mesquita - Nov $lat_id$8                      *<br />!   *  Bjerknes Centre for Climate Research                       *<br />!   ***************************************************************<br />subroutine get_time(get_timeid)<br />implicit none<br /><br />character (19) , dimension(1:365), intent(inout) :: get_timeid<br />character (10) :: A<br />character (8) :: B<br />integer i<br /><br />print *, 'reading subroutine get_time...'<br /><br />do i=1,365<br />   open(unit=5, file='date_file')<br />   read(5,*) A, B<br />   get_timeid(i) = A // ' ' // B  ! concatenate the strings<br />!   print *, get_timeid<br />end do<br />   close(5)<br /><br /><br />end subroutine get_time<br /><br /> subroutine read_netcdf_2(lat,lon,time,vals)<br />      implicit none<br /><br />       include '/usr/local/netcdf-4.1.3-gcc45/include/netcdf.inc'<br />      integer ncid,ierr,dimidx,dimidy,dimidz,dimidt,varid,varidx,varidy<br />      integer varidz,varidt,startA(1),countA(1),startB(4),countB(4)<br />      integer ns,nv,lenx,leny,lenz,var0,lent,niv,err<br />     integer n1,n2,n3<br />      character(len=4) variable(13),varn(13),field_i(13)<br />       real*4 , dimension(1:64) :: lat<br />       real*4 , dimension(1:128) :: lon<br />       real*4 , dimension(1:365) :: time<br />      character(len=70) cha1<br />      character(len=16) cha2<br />      character(len=88) cha_0<br />      character(len=89) cha<br />      character(len=90) cha_1<br />!      real*4 valsx(128),valsy(64),valsz(10),valst(365),vals(365,10,64,128,5)<br />       real*4 valsx(128),valsy(64),valsz(10),valst(365),vals(128,64,10,365,5)<br />       integer, parameter :: version=5             ! Format version (must =5 for WPS format)<br />        integer, parameter :: nx=128<br />        integer, parameter :: ny=64               ! x- and y-dimensions of 2-d array<br />        integer, parameter :: lev=10<br />         integer, parameter :: iproj=0               ! Code for projection of data in array:<br />                              !       0 = cylindrical equidistant<br />                             !       1 = Mercator<br />                              !       3 = Lambert conformal conic<br />                              !       4 = Gaussian (global only!)<br />                              !       5 = Polar stereographic<br />        real, parameter :: nlats=0                  ! Number of latitudes north of equator<br />                              !       (for Gaussian grids)<br />        real, parameter :: startlat=-87.8638<br />        real, parameter ::  startlon=0     ! Lat/lon of point in array indicated by<br />                              !       startloc string<br />        real, parameter ::  deltalat=2.7672<br />        real, parameter ::  deltalon=2.8125     ! Grid spacing, degrees<br />        real, parameter :: dx=1.181168<br />        real, parameter :: dy=1.125966                 ! Grid spacing, km<br />        real, parameter :: xlonc=0                  ! Standard longitude of projection<br />        real, parameter :: truelat1=0<br />         real, parameter :: truelat2=0     ! True latitudes of projection<br />        real, parameter :: earth_radius=6367470. * .001           ! Earth radius, km<br />        logical, parameter :: is_wind_grid_rel=.false.    ! Flag indicating whether winds are<br />                              !       relative to source grid (TRUE) or<br />                              !       relative to earth (FALSE)<br />        character (len=8), parameter  :: startloc='SWCORNER' ! Which point in array is given by<br />                              !       startlat/startlon; set either<br />                              !       to 'SWCORNER' or 'CENTER  '<br />        !<br />        !<br />        ! A MODIFIER ICI LE VARIABLE<br />        !<br />        !<br />        character(len=8)   :: field<br />        real, parameter :: sst_intv = 24. ! input SST interval hours<br />        !<br />        ! dynamic output variables<br />        !<br />         real :: xfcst   ! Forecast hour of data (hours from ifile1)<br />         character(len=24) :: hdate='1979:01:01_00:00:00' ! Valid date for data YYYY:MM:DD_HH:00:00<br />       !<br />         ! other variables<br />         !<br />          character(256) :: ifile1, ifile2, ofile<br />          integer, parameter :: iunit1 = 10, iunit2 = 20, ounit = 100<br />        call getarg(1, ifile1)<br />        call getarg(2, ifile2)<br />        call getarg(3, ofile)<br />        call getarg(4, hdate)<br />        xfcst=24<br /><br />       variable(1)='zg_d';varn(1)='zg';field_i(1)='GHT'<br />       variable(2)='ta_d';varn(2)='ta';field_i(2)='TT'<br />       variable(3)='ua_d';varn(3)='ua';field_i(3)='UU'<br />       variable(4)='va_d';varn(4)='va';field_i(4)='VV'<br />       variable(5)='hur_';varn(5)='hur';field_i(5)='RH'<br /><br />        n1=4<br />        n2=5<br />        n3=5<br />       nv=5<br />!*     Declare functions and variables associated with the netCDF library<br />!      integer NF_OPEN,NF_NOWRITE,NF_INQ_DIMID,NF_INQ_VARID,NF_INQ_DIMLEN<br />!      integer NF_GET_VARA_REAL,NF_CLOSE<br /><br /><br />!*     1. Open the netCDF file<br />!*     -----------------------<br />     do ns=1,nv<br />      field=field_i(ns)<br />            cha1='/work/crct/mo9378al/ARPEGE/arpege-ieee_grib_netcdf/ARPEGE/sorties/EH1/'<br />       if (ns .le. n1) then<br />           cha=cha1//variable(ns)//'.PLEH1.1979.nc'<br />       elseif ((ns .gt. n1) .and. (ns .le. n2)) then<br />           cha=cha1//variable(ns)//'d.PLEH1.1979.nc'<br />        elseif ((ns .gt. n2) .and. (ns .le. n3)) then<br />           cha=cha1//variable(ns)//'_d.PLEH1.1979.nc'<br />      endif<br />       ierr=NF_OPEN(cha,NF_NOWRITE,ncid)<br />      print *, ierr,ncid,cha<br />!*<br />!*     2. Get dimension IDs<br />!*     --------------------<br />      ierr=NF_INQ_DIMID(ncid,'lon',dimidx)<br />      ierr=NF_INQ_DIMID(ncid,'lat',dimidy)<br />      ierr=NF_INQ_DIMID(ncid,'plev',dimidz)<br />      ierr=NF_INQ_DIMID(ncid,'time',dimidt)<br /><br />!*<br />!*     3. Get dimension lengths<br />!*     ------------------------<br />      ierr=NF_INQ_DIMLEN(ncid,dimidx,lenx)<br />      ierr=NF_INQ_DIMLEN(ncid,dimidy,leny)<br />      ierr=NF_INQ_DIMLEN(ncid,dimidz,lenz)<br />      ierr=NF_INQ_DIMLEN(ncid,dimidt,lent)<br />      print*,'Dimension lengths',lenx,leny,lenz,lent<br /><br />!*     4. Get variable IDs<br />!*     -------------------<br />!*     First the variables for the dimensions<br />      ierr=NF_INQ_VARID(ncid,'lon',varidx)<br />      ierr=NF_INQ_VARID(ncid,'lat',varidy)<br />      ierr=NF_INQ_VARID(ncid,'plev',varidz)<br />      ierr=NF_INQ_VARID(ncid,'time',varidt)<br />!<br />!     IMPORTANT, IMPORTANT<br />!*     ...and for the main data variable<br />!<br />      ierr=NF_INQ_VARID(ncid,varn(ns),varid)<br />!*<br />!*     5. Get contents of dimension variables<br />!*     --------------------------------------<br />      startA(1)=1<br />      countA(1)=lenx<br />      ierr=NF_GET_VARA_REAL(ncid,varidx,startA,countA,valsx)<br />      startA(1)=1<br />      countA(1)=leny<br />      ierr=NF_GET_VARA_REAL(ncid,varidy,startA,countA,valsy)<br />      startA(1)=1<br />      countA(1)=lenz<br />      ierr=NF_GET_VARA_REAL(ncid,varidz,startA,countA,valsz)<br />      startA(1)=1<br />      countA(1)=lent<br />      ierr=NF_GET_VARA_REAL(ncid,varidt,startA,countA,valst)<br />!*<br />!*     6. Get values of the main variable<br />!*     ----------------------------------<br />      startB(1)=1<br />      startB(2)=1<br />      startB(3)=1<br />      startB(4)=1<br />      countB(1)=lenx<br />      countB(2)=leny<br />      countB(3)=lenz<br />      countB(4)=lent<br />!      print*,'Dimension lengths',lenx,leny,lenz,lent<br />!      print *,'------------------vals_x est',valsx<br />!      print *, '--------------- vals_y est', valsy<br />!      print *, '--------------- vals_z est', valsz<br />!      print *, '--------------- vals_t est', valst<br />      ierr=NF_GET_VARA_REAL(ncid,varid,startB,countB,vals(:,:,:,:,ns))<br /><br />!      print *, 'here_here_here',minval(vals),maxval(vals),vals(:,:,:,:,ns)<br />!*     7. Close the file up<br />!*     --------------------<br />      err=NF_CLOSE(ncid)<br />    enddo<br /><br />  end<br /><br />-------------<br /><br />Mouhamad</div>

			

		</div>

		
			<dl class="postprofile" id="profile16645">
			<dt>
				<a href="./memberlist.php?mode=viewprofile&amp;u=7202">alsayed</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 23</dd><dd><strong>Joined:</strong> Fri Nov 18, 2011 7:30 am</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="./viewtopic.php?f=22&amp;t=2481&amp;start=10">

	<fieldset class="display-options" style="margin-top: 0; ">
		<a href="./viewtopic.php?f=22&amp;t=2481&amp;start=0" class="left-box left">Previous</a>
		<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
		<div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=22&amp;t=2481" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			11 posts
			 &bull; <a href="#" onclick="jumpto(); return false;" title="Click to jump to page…">Page <strong>2</strong> of <strong>2</strong></a> &bull; <span><a href="./viewtopic.php?f=22&amp;t=2481">1</a><span class="page-sep">, </span><strong>2</strong></span>
		</div>
	
</div>


	<p></p><p><a href="./viewforum.php?f=22" class="left-box left" accesskey="r">Return to Working with Various Datasets</a></p>

	<form method="post" id="jumpbox" action="./viewforum.php" onsubmit="if(document.jumpbox.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="3">Welcome</option>
			
				<option value="47">&nbsp; &nbsp;Welcome to the WRF User's Forum</option>
			
				<option value="4">WRF Model</option>
			
				<option value="5">&nbsp; &nbsp;Installation</option>
			
				<option value="6">&nbsp; &nbsp;Runtime Problems</option>
			
				<option value="7">&nbsp; &nbsp;Software Engineering</option>
			
				<option value="8">&nbsp; &nbsp;Dynamics and Numerics</option>
			
				<option value="10">&nbsp; &nbsp;Nesting</option>
			
				<option value="9">&nbsp; &nbsp;Physics</option>
			
				<option value="11">&nbsp; &nbsp;Idealized Simulations</option>
			
				<option value="12">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="48">&nbsp; &nbsp;WRF Portal (GUI for running WRF)</option>
			
				<option value="19">WRF Preprocessing System (WPS, for WRF v2.2 and later versions)</option>
			
				<option value="20">&nbsp; &nbsp;Installation</option>
			
				<option value="21">&nbsp; &nbsp;Runtime Problems</option>
			
				<option value="23">&nbsp; &nbsp;Nesting</option>
			
				<option value="22" selected="selected">&nbsp; &nbsp;Working with Various Datasets</option>
			
				<option value="24">&nbsp; &nbsp;WRF Domain Wizard</option>
			
				<option value="52">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="25">WRF 3DVAR</option>
			
				<option value="26">&nbsp; &nbsp;Data Issues</option>
			
				<option value="27">&nbsp; &nbsp;Installation</option>
			
				<option value="28">&nbsp; &nbsp;Runtime Problems</option>
			
				<option value="29">Graphics and Post-Processing</option>
			
				<option value="30">&nbsp; &nbsp;ARWPost</option>
			
				<option value="31">&nbsp; &nbsp;GrADS</option>
			
				<option value="58">&nbsp; &nbsp;MET Tools</option>
			
				<option value="32">&nbsp; &nbsp;NCL</option>
			
				<option value="33">&nbsp; &nbsp;Others</option>
			
				<option value="34">&nbsp; &nbsp;RIP4</option>
			
				<option value="35">&nbsp; &nbsp;Vapor</option>
			
				<option value="53">&nbsp; &nbsp;WRF Post Processor V3</option>
			
				<option value="36">&nbsp; &nbsp;Vis5D</option>
			
				<option value="37">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="38">WRF Chemistry</option>
			
				<option value="39">&nbsp; &nbsp;Installation</option>
			
				<option value="40">&nbsp; &nbsp;Initialization</option>
			
				<option value="41">&nbsp; &nbsp;Runtime Problems</option>
			
				<option value="13">WRF Standard Initialization</option>
			
				<option value="14">&nbsp; &nbsp;Installation</option>
			
				<option value="15">&nbsp; &nbsp;Runtime Problems</option>
			
				<option value="16">&nbsp; &nbsp;Working with Various Datasets</option>
			
				<option value="17">&nbsp; &nbsp;Nesting</option>
			
				<option value="18">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="42">Miscellaneous</option>
			
				<option value="43">&nbsp; &nbsp;Bugs</option>
			
				<option value="44">&nbsp; &nbsp;Updates</option>
			
				<option value="45">&nbsp; &nbsp;Forum Feedback</option>
			
				<option value="46">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="57">&nbsp; &nbsp;Job/Position Opportunities</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 3 guests</p>
</div>
    
                <div id="page-footer">
                
<div id='meso_footer' style="background-image:none; font-weight:bold;">
                 <div id='wxarc_footer_div' style="float: left; display:inline;background-image:none;">
                   <p align='center'>
      Looking for data to run the WRF? Visit: <br>
      <a href="http://www.weatherarc.com/model" title="Weather Arc" target='_blank' id="sponsor_logo" onClick="javascript: pageTracker._trackPageview('/outbound/sponsorads/meso/wxarc_bottom_1');"><img src="/wxarc-smaller.jpg" width="125" height="50" alt="" title="" style="vertical-align:middle;" /></a>
    </p>
  </div>
  <div id='meso_footer_div' style="float: right; display:inline;background-image:none;">
    <p align='center'>
      Need help setting up or configuring the WRF? Visit: <br>
      <a href="http://www.meso.com" title="MESO Inc" target='_blank' id="sponsor_logo" onClick="javascript: pageTracker._trackPageview('/outbound/sponsorads/meso/meso_bottom_1');"><img src="/meso_logo_small_105x70.jpg" width="105" height="70" alt="" align='center' title="" style="vertical-align:middle;" /></a>
    </p>
  </div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</div>
                	<div class="navbar">
                		<div class="inner"><span class="corners-top"><span></span></span>
                
                		<ul class="linklist">
                			<li class="icon-home"><a href="./index.php" accesskey="h">Board index</a></li>
                				
                            <li class="rightside"><a href="./memberlist.php?mode=leaders">The team</a> &bull; <a href="./ucp.php?mode=delete_cookies">Delete all board cookies</a> &bull; All times are UTC - 5 hours [ <abbr title="Daylight Saving Time">DST</abbr> ]</li>
                		</ul>
                
                		<span class="corners-bottom"><span></span></span></div>

                	</div>

               </div>

               
            </div>
            <div class="border-bottom">
              <span><span></span></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
	
<!--
	We request you retain the full copyright notice below including the link to www.phpbb.com.
	This not only gives respect to the large amount of time given freely by the developers
	but also helps build interest, traffic and use of phpBB3. If you (honestly) cannot retain
	the full copyright we ask you at least leave in place the "Powered by phpBB" line, with
	"phpBB" linked to www.phpbb.com. If you refuse to include even this then support on our
	forums may be affected.

	The phpBB Group : 2006
//-->

	<div class="copyright">Powered by <a href="http://www.phpbb.com/">phpBB</a> &copy; 2000, 2002, 2005, 2007 phpBB Group
		
	</div>



<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
</div>

</body>
</html>